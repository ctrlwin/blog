---
title: 使用vue的model选项实现组件通信
date: 2021-11-17 18:11:28
permalink: /pages/b46e18/
categories:
  - 前端
  - Vue
  - 知识点
tags:
  - vue
---
# 使用vue的model选项实现组件通信

了解过v-model的应该都知道，它只是一个语法糖，真正实现的形式是：

```vue
<input type="text" :value="message" @input="message = $event.target.value">
```

**实现流程：**

1. 将输入框的值绑定到`message`变量上，这只是单向的，改变`message`的值可以改变`input`的`value`，但是改变`input`的输入不会改变`message`。

2. 监听`input`事件，当输入类内容时改变`message`变量，从而实现了双向绑定。

从官网上看到，`v-model`在内部为不同的输入元素使用不同的属性并抛出不同的事件：

* `text`和`textarea`元素使用`value`属性和`input`事件

* `checkbox`和`radio`使用`checked`属性和`change`事件

* `select`使用`value`和`change`事件

那么，知道原理后，我们来实现v-model也就是*双向绑定*，就不难了：

**子组件**

```vue
<template>
    <input type="text" :value="uname" @input="updateVal($event.target.value)" />
</template>
<script>
export default{
	model: {
        prop: 'uname',
        // 随便命名事件，对应下面$emit即可
        event: 'changeXXX'
    },
    props: {
        uname: {
            type: String,
            default: 'tom'
        }
    },
    methods: {
        updateVal(val){
            this.$emit('changeXXX',val)
        }
    }
}
</script>
```

**父组件**

父组件使用直接用v-model就可以了

```vue
<my-input v-model="name" value="some value" />
```


**补充**
https://mp.weixin.qq.com/s/Ov5vte3WAvNcABPt0aAoag