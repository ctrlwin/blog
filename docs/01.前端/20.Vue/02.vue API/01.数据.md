---
title: 数据
date: 2021-07-09 15:31:13
permalink: /pages/63b7bd/
categories:
  - 前端
  - Vue
  - vue API
tags:
  - vue
---

# 数据

### data

- **类型**：<span style="color:#d63200">Object | Function</span>

- **限制**：组件的定义只接受 `function`。

- **详细**：

  Vue 实例的数据对象。Vue 会递归地把 data 的 property 转换为 getter/setter，从而让 data 的 property 能够响应数据变化。**对象必须是纯粹的对象 (含有零个或多个的 key/value 对)**：浏览器 API 创建的原生对象，原型上的 property 会被忽略。大概来说，data 应该只能是数据 - 不推荐观察拥有状态行为的对象。

<!-- more -->

### props

- **类型**：<span style="color:#d63200">Array \<string> | Object</span>

- **详细**：

  props 可以是数组或对象，用于接收来自父组件的数据。props 可以是简单的数组，或者使用对象作为替代，对象允许配置高级选项，如类型检测、自定义验证和设置默认值。

  你可以基于对象的语法使用以下选项：

  - <span style="color:#d63200">type</span>：可以是下列原生构造函数中的一种：<span style="color:#d63200">String</span>、<span style="color:#d63200">Number</span>、<span style="color:#d63200">Boolean</span>、<span style="color:#d63200">Array</span>、<span style="color:#d63200">Object</span>、<span style="color:#d63200">Date</span>、<span style="color:#d63200">Function</span>、<span style="color:#d63200">Symbol</span>、任何自定义构造函数、或上述内容组成的数组。会检查一个 prop 是否是给定的类型，否则抛出警告。Prop 类型的[更多信息在此](https://cn.vuejs.org/v2/guide/components-props.html#Prop-类型)。
  - <span style="color:#d63200">default : any</span>
    为该 prop 指定一个默认值。如果该 prop 没有被传入，则换做用这个值。对象或数组的默认值必须从一个工厂函数返回。
  - <span style="color:#d63200">require : Boolean</span>
    定义该 prop 是否是必填项。在非生产环境中，如果这个值为 truthy 且该 prop 没有被传入的，则一个控制台警告将会被抛出。
  - <span style="color:#d63200">validator : Function</span>
    自定义验证函数会将该 prop 的值作为唯一的参数代入。在非生产环境下，如果该函数返回一个 falsy 的值 (也就是验证失败)，一个控制台警告将会被抛出。你可以在[这里](https://cn.vuejs.org/v2/guide/components-props.html#Prop-验证)查阅更多 prop 验证的相关信息

- **prop验证：**

  ```js
  Vue.component('my-component', {
    props: {
      // 基础的类型检查 (`null` 和 `undefined` 会通过任何类型验证)
      propA: Number,
      // 多个可能的类型
      propB: [String, Number],
      // 必填的字符串
      propC: {
        type: String,
        required: true
      },
      // 带有默认值的数字
      propD: {
        type: Number,
        default: 100
      },
      // 带有默认值的对象
      propE: {
        type: Object,
        // 对象或数组默认值必须从一个工厂函数获取
        default: function () {
          return { message: 'hello' }
        }
      },
      // 自定义验证函数
      propF: {
        validator: function (value) {
          // 这个值必须匹配下列字符串中的一个
          return ['success', 'warning', 'danger'].indexOf(value) !== -1
        }
      }
    }
  })
  ```

  ::: warning

  prop 会在一个组件实例创建**之前**进行验证，所以实例的 property (如 `data`、`computed` 等) 在 `default` 或 `validator` 函数中是不可用的。

  :::

- **参考**：[Props](https://cn.vuejs.org/v2/guide/components-props.html)

### computed

- **类型**：<span style="color:#d63200">{ [key: string]: Function | { get: Function, set: Function } }</span>

- **详细**：

  计算属性将被混入到 Vue 实例中。所有 getter 和 setter 的 this 上下文自动地绑定为 Vue 实例。

  注意如果你为一个计算属性使用了箭头函数，则 `this` 不会指向这个组件的实例，不过你仍然可以将其实例作为函数的第一个参数来访问。

  ```vue
  computed: {
    aDouble: vm => vm.a * 2
  }
  ```

  计算属性的结果会被缓存，除非依赖的响应式 property 变化才会重新计算（<span style="color:#000000;font-weight:500;">简单说就是只有computed依赖的变量改变，computed才会更新</span>）。注意，如果某个依赖 (比如非响应式 property) 在该实例范畴之外，则计算属性是**不会**被更新的。

- **参考**：[计算属性](https://cn.vuejs.org/v2/guide/computed.html)

### methods

- **类型**：<span style="color:#d63200">{ [key: string]: Function }</span>

- **详细**：

  methods 将被混入到 Vue 实例中。可以直接通过 VM 实例访问这些方法，或者在指令表达式中使用。方法中的 `this` 自动绑定为 Vue 实例。

  ::: warning

  **不应该使用箭头函数来定义 method 函数** (例如 `plus: () => this.a++`)。理由是箭头函数绑定了父级作用域的上下文，所以 `this` 将不会按照期望指向 Vue 实例，`this.a` 将是 undefined。

  :::

- **参考**：[事件处理器](https://cn.vuejs.org/v2/guide/events.html)

### watch

- **类型**：<span style="color:#d63200">{ [key: string]: string | Function | Object | Array }</span>

- **详细**：

  一个对象，键是需要观察的表达式，值是对应回调函数。值也可以是方法名，或者包含选项的对象。Vue 实例将会在实例化时调用 `$watch()`，遍历 watch 对象的每一个 property。

  ::: warning

  **不应该使用箭头函数来定义 watcher 函数** (例如 `searchQuery: newValue => this.updateAutocomplete(newValue)`)。理由是箭头函数绑定了父级作用域的上下文，所以 `this` 将不会按照期望指向 Vue 实例，`this.updateAutocomplete` 将是 undefined。

  :::

- **参考**：[实例方法 / 数据 - vm.$watch](https://cn.vuejs.org/v2/api/?#vm-watch)